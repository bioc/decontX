% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/decontPro.R
\name{decontPro}
\alias{decontPro}
\alias{decontPro,SingleCellExperiment-method}
\alias{decontPro,Seurat-method}
\alias{decontPro,ANY-method}
\title{Decontaminate using decontPro}
\usage{
decontPro(object, cell_type, ...)

\S4method{decontPro}{SingleCellExperiment}(object, cell_type, delta_sd = 2e-05, background_sd = 2e-06, ...)

\S4method{decontPro}{Seurat}(object, cell_type, delta_sd = 2e-05, background_sd = 2e-06, ...)

\S4method{decontPro}{ANY}(object, cell_type, delta_sd = 2e-05, background_sd = 2e-06, ...)
}
\arguments{
\item{object}{Data matrix NxM (feature x droplet).}

\item{cell_type}{1xM vector of cell type. 1-based.}

\item{...}{Additional arguments for generics.}

\item{delta_sd}{Prior variance for ambient contamination level. Default to 2e-5.}

\item{background_sd}{Prior variance for background contamination level. Default to 2e-6.}
}
\value{
A list containing decontaminated counts, and estimated parameters.
}
\description{
Decontaminate using decontPro
}
\examples{
# # Load CITE-seq dataset
# library(DropletUtils)
# sce_filtered <- read10xCounts('filtered_feature_bc_matrix')
# adt_filtered <- sce_filtered[rowData(sce_filtered)$Type == 'Antibody Capture',]
#
# # Generate cell clusters
# library(Seurat)
# library(dplyr)
# adt_seurat <- CreateSeuratObject(counts(adt_filtered), assay = 'ADT')
# adt_seurat <- NormalizeData(adt_seurat, normalization.method = "CLR",
#   margin = 2) \%>\%
#   ScaleData(assay = "ADT") \%>\%
#   RunPCA(assay = "ADT", features = rownames(adt_seurat),
#   reduction.name = "pca_adt", npcs = 10) \%>\%
#   FindNeighbors(dims = 1:10, assay = "ADT", reduction = "pca_adt") \%>\%
#   FindClusters(resolution = 0.2)
#
# clusters = as.integer(Idents(adt_seurat))
#
# # Run DecontPro
# counts <- as.matrix(counts(adt_filtered))
# out <- decontPro(counts, clusters)
#
# decontaminated_counts <- out$decontaminated_counts


}
